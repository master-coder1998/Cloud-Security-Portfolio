title = "Gitleaks Configuration for AWS Security Pipeline"

[extend]
useDefault = true

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["key", "AWS"]
[[rules.Entropies]]
    Min = "3.5"
    Max = "4.5"

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["key", "AWS"]

[[rules]]
id = "aws-account-id"
description = "AWS Account ID"
regex = '''(?i)aws(.{0,20})?account(.{0,20})?['\"]?[0-9]{12}['\"]?'''
tags = ["AWS"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
id = "github-oauth"
description = "GitHub OAuth Token"
regex = '''gho_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''
tags = ["key", "Slack"]

[[rules]]
id = "slack-webhook"
description = "Slack Webhook"
regex = '''https://hooks\.slack\.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}'''
tags = ["key", "Slack"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'''
tags = ["key", "private"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret)(.{0,20})?['\"][0-9a-zA-Z]{32,45}['\"]'''
tags = ["key", "API"]

[[rules]]
id = "password-in-url"
description = "Password in URL"
regex = '''[a-zA-Z]{3,10}://[^/\s:@]{3,20}:[^/\s:@]{3,20}@.{1,100}'''
tags = ["password"]

[[rules]]
id = "database-connection-string"
description = "Database Connection String"
regex = '''(?i)(jdbc|mongodb|mysql|postgresql|sqlserver)://[^\s]+'''
tags = ["database"]

[allowlist]
description = "Allowlist for false positives"
paths = [
    '''\.git/''',
    '''node_modules/''',
    '''vendor/''',
    '''\.terraform/''',
    '''\.tfstate''',
    '''\.tfstate\.backup''',
]

regexes = [
    '''AKIA[0-9A-Z]{16}EXAMPLE''',  # Example AWS keys
    '''wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY''',  # Example AWS secret
    '''123456789012''',  # Example AWS account ID
]

[[allowlist.regexTarget]]
regex = '''(?i)(example|sample|test|dummy|fake|mock)'''
